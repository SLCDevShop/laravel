<?php

namespace App\Services;

use App\Events\{pascalName}Created;
use App\Events\{pascalName}Deleted;
use App\Events\{pascalName}Updated;
use App\Http\Requests\{pascalName}CreateRequest;
use App\Http\Requests\{pascalName}UpdateRequest;
use App\Models\{pascalName};

class {pascalName}Service
{
    public function create({pascalName}CreateRequest $request): {pascalName}
    {
        return \DB::transaction(function () use ($request) {
            $data = [{createFields}
            ];

            ${camelCaseName} = new {pascalName}($data);
            ${camelCaseName}->save();

{createRelationshipsFields}
            event(new {pascalName}Created(${camelCaseName}));

            return ${camelCaseName};
        });
    }

    public function update({pascalName}UpdateRequest $request, {pascalName} ${camelCaseName}): {pascalName}
    {
        return \DB::transaction(function () use ($request, ${camelCaseName}) {
            {updateFields}

            ${camelCaseName}->save();

{createRelationshipsFields}
            event(new {pascalName}Updated(${camelCaseName}));

            return ${camelCaseName};
        });
    }

    public function delete({pascalName} ${camelCaseName})
    {
        return \DB::transaction(function() use (${camelCaseName}) {
           ${camelCaseName}->delete();

           event(new {pascalName}Deleted(${camelCaseName}));
        });
    }
}